# =============================================================================
# Knecta - Production Environment Variables
# =============================================================================
# Copy to .env and fill in real values:
#   cp .env.example .env
#   nano .env
#
# NEVER commit .env to version control.
#
# Generate secrets:
#   openssl rand -base64 32
#   node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# =============================================================================

# --- Application ---
NODE_ENV=production
PORT=3000
APP_URL=https://knecta.marin.cr
LOG_LEVEL=info

# --- PostgreSQL (external cloud database) ---
# Point to your existing cloud-hosted PostgreSQL instance.
# The API constructs DATABASE_URL from these individual variables.
POSTGRES_HOST=CHANGE_ME_YOUR_PG_HOST
POSTGRES_PORT=5432
POSTGRES_USER=CHANGE_ME_PG_USER
POSTGRES_PASSWORD=CHANGE_ME_PG_PASSWORD
POSTGRES_DB=knecta
POSTGRES_SSL=true

# --- Neo4j ---
NEO4J_USER=neo4j
NEO4J_PASSWORD=CHANGE_ME_NEO4J_PASSWORD
NEO4J_PORT=7687
# NEO4J_HOST is set in compose.yml (=neo4j), do not set here

# --- JWT / Session ---
# Generate with: openssl rand -base64 32
JWT_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL
JWT_ACCESS_TTL_MINUTES=15
JWT_REFRESH_TTL_DAYS=14
COOKIE_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL

# --- OAuth: Google (Required) ---
# Get credentials: https://console.cloud.google.com/apis/credentials
# Add authorized redirect URI: https://knecta.marin.cr/api/auth/google/callback
GOOGLE_CLIENT_ID=CHANGE_ME_GOOGLE_CLIENT_ID
GOOGLE_CLIENT_SECRET=CHANGE_ME_GOOGLE_CLIENT_SECRET
GOOGLE_CALLBACK_URL=https://knecta.marin.cr/api/auth/google/callback

# --- Initial Admin ---
# First user to log in with this email becomes Admin
INITIAL_ADMIN_EMAIL=admin@example.com

# --- Encryption (AES-256-GCM for database connection credentials) ---
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# Or: openssl rand -base64 32
ENCRYPTION_KEY=CHANGE_ME_GENERATE_32_BYTE_KEY

# --- S3 Storage ---
STORAGE_PROVIDER=s3
S3_BUCKET=CHANGE_ME_BUCKET_NAME
S3_REGION=us-east-1
AWS_ACCESS_KEY_ID=CHANGE_ME_ACCESS_KEY
AWS_SECRET_ACCESS_KEY=CHANGE_ME_SECRET_KEY
MAX_FILE_SIZE=10737418240     # 10GB in bytes
ALLOWED_MIME_TYPES=image/*,application/pdf,video/*
SIGNED_URL_EXPIRY=3600        # 1 hour
STORAGE_PART_SIZE=10485760    # 10MB

# --- LLM Providers (at least one required) ---
LLM_DEFAULT_PROVIDER=openai
# OpenAI
OPENAI_API_KEY=CHANGE_ME_OPENAI_KEY
OPENAI_MODEL=gpt-4o
# Anthropic (optional)
ANTHROPIC_API_KEY=
ANTHROPIC_MODEL=claude-sonnet-4-5-20250929
# Azure OpenAI (optional, all 4 required if using)
# AZURE_OPENAI_API_KEY=
# AZURE_OPENAI_ENDPOINT=
# AZURE_OPENAI_DEPLOYMENT=
# AZURE_OPENAI_API_VERSION=2024-02-01

# --- Embedding ---
EMBEDDING_DEFAULT_PROVIDER=openai

# --- Observability (optional, disabled by default) ---
OTEL_ENABLED=false
# OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
OTEL_SERVICE_NAME=knecta-api

# --- Device Authorization (RFC 8628) ---
DEVICE_CODE_EXPIRY_MINUTES=15
DEVICE_CODE_POLL_INTERVAL=5
