# =============================================================================
# Environment Variables Template
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# IMPORTANT: Never commit .env to version control
# =============================================================================

# -----------------------------------------------------------------------------
# Application
# -----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000
APP_URL=http://localhost:3535

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# -----------------------------------------------------------------------------
# Individual connection parameters (DATABASE_URL is constructed from these)
POSTGRES_HOST=db
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=appdb
POSTGRES_SSL=false

# -----------------------------------------------------------------------------
# JWT / Session
# -----------------------------------------------------------------------------
# IMPORTANT: Generate a strong secret for production (min 32 characters)
# Example: openssl rand -base64 32
JWT_SECRET=your-super-secret-key-min-32-characters-long
JWT_ACCESS_TTL_MINUTES=15
JWT_REFRESH_TTL_DAYS=14
COOKIE_SECRET=your-cookie-secret-key-min-32-characters-long

# -----------------------------------------------------------------------------
# OAuth - Google (Required)
# -----------------------------------------------------------------------------
# Get credentials from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_CALLBACK_URL=http://localhost:3535/api/auth/google/callback

# -----------------------------------------------------------------------------
# OAuth - Microsoft (Optional)
# -----------------------------------------------------------------------------
# Get credentials from: https://portal.azure.com
# MICROSOFT_CLIENT_ID=your-microsoft-client-id
# MICROSOFT_CLIENT_SECRET=your-microsoft-client-secret
# MICROSOFT_CALLBACK_URL=http://localhost:3535/api/auth/microsoft/callback

# -----------------------------------------------------------------------------
# Initial Admin Bootstrap
# -----------------------------------------------------------------------------
# First user to log in with this email will be assigned Admin role
INITIAL_ADMIN_EMAIL=admin@example.com

# -----------------------------------------------------------------------------
# Test Authentication (Development/Test Only)
# -----------------------------------------------------------------------------
# Test auth is automatically enabled when NODE_ENV !== 'production'
# This provides /api/auth/test/login endpoint and /testing/login page
# for Playwright E2E testing without requiring real OAuth credentials.
#
# Set to 'false' to explicitly disable test auth in development:
# TEST_AUTH_ENABLED=false
#
# WARNING: Setting TEST_AUTH_ENABLED=true in production will cause the app
# to fail at startup as a safety measure.

# -----------------------------------------------------------------------------
# Device Authorization Flow (RFC 8628)
# -----------------------------------------------------------------------------
# Configuration for device authorization (CLI, Swagger UI, mobile apps)
DEVICE_CODE_EXPIRY_MINUTES=15
DEVICE_CODE_POLL_INTERVAL=5

# -----------------------------------------------------------------------------
# Observability (OpenTelemetry)
# -----------------------------------------------------------------------------
OTEL_ENABLED=true
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
OTEL_SERVICE_NAME=enterprise-app-api
LOG_LEVEL=info
# OTEL_DEBUG=true  # Uncomment to enable OTEL diagnostic logging (development only)

# -----------------------------------------------------------------------------
# Uptrace (when using docker-compose.otel.yml)
# -----------------------------------------------------------------------------
UPTRACE_DSN=http://project1_secret_token@localhost:14317/1

# -----------------------------------------------------------------------------
# ClickHouse (Uptrace storage - typically no changes needed)
# -----------------------------------------------------------------------------
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=

# -----------------------------------------------------------------------------
# Storage Configuration
# -----------------------------------------------------------------------------
# Storage provider (currently only 's3' is supported)
STORAGE_PROVIDER=s3

# S3 Storage Settings
# For AWS S3: Set region and credentials, leave S3_ENDPOINT empty
# For MinIO/LocalStack: Set S3_ENDPOINT to your local service URL
S3_BUCKET=your-bucket-name
S3_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
# S3_ENDPOINT=http://localhost:9000  # Optional: for MinIO/LocalStack

# Storage Limits and Configuration
MAX_FILE_SIZE=10737418240  # 10GB in bytes
ALLOWED_MIME_TYPES=image/*,application/pdf,video/*
SIGNED_URL_EXPIRY=3600  # Signed URL expiration in seconds (1 hour)
STORAGE_PART_SIZE=10485760  # Multipart upload part size in bytes (10MB)
